/*
 ============================================================================
 Name        : Parcial-laboratorio-1.c
 Author      : Gonzalo Vidal
 Version     :
 Copyright   : Parcial laboratorio
 Description : Hello World in C, Ansi-style
 ============================================================================
 */

#include <stdio.h>
#include <stdlib.h>
#include "General.h"
#include "User.h"
#include "Product.h"

int main(void) {
	setbuf(stdout, NULL);
	User userList[MAX_USERS];
	Product productList[MAX_PRODUCTS];
	int r;
	int startOption;
	int userOption;
	int adminOption;
	User auxList[MAX_USERS];
	Product auxProduct[MAX_PRODUCTS];
	strncpy(auxList[0].email, "gonzalo", 50);
	strncpy(auxList[0].password, "vidal", 50);
	strncpy(auxProduct[0].productName, "caca", 50);
	auxProduct[0].category = 1;
	auxProduct[0].idProduct = 1000;
	auxProduct[0].stock = 50;
	auxProduct[0].price = 50;
	auxProduct[0].isEmpty = OCCUPIED;
	auxList[0].type = 1;

	User_initializeUsers(userList, MAX_USERS);

	printMessage("BIENVENIDO A NUESTRO PROGRAMA", 2);

	do {
		utn_getNumero("1)Ingresar\n2)Registrarse\n\n0)Salir\n",
				"Ha habido un error\n", 0, 3, &startOption);
		switch (startOption) {
		case 1:
			r = User_Login(auxList, MAX_USERS);
			if (r == 2) {
				printMessage("¡Bienvenido admin!", 2);
				do {
					utn_getNumero(
							"1)Comprar\n2)Vender\n3)Estado de compras\n4)Estado de ventas\n0)Salir\n",
							"Ha habido un error\n", 0, 3, &adminOption);
					switch (adminOption) {
					case 1:
						break;
					case 2:
						break;
					case 3:
						break;
					case 4:
						break;
					case 0:
						break;
					default:
						break;
					}
				} while (adminOption != 0);
				//MENU ADMIN
			} else {
				if (r == 1) {
					printMessage("¡Bienvenido usuario!", 2);
					do {
						utn_getNumero(
								"1)Comprar\n2)Vender\n3)Estado de compras\n4)Estado de ventas\n0)Salir\n",
								"Ha habido un error\n", 0, 3, &userOption);
						switch (userOption) {
						case 1:
							r = Product_BuyProduct(auxProduct, MAX_PRODUCTS);
							if(r == 0){
								printMessage("Compra realizada con exito!",2);
							} else {
								if(r == -2){
									printMessage("Compra no realizada.",2);
								} else {
									printMessage("Hubo una falla en la lista de productos.", 2);
								}
							}
							break;
						case 2:
							if(Product_SellProduct(productList, MAX_PRODUCTS) == 0){

							}
							break;
						case 3:
							break;
						case 4:
							break;
						case 0:
							break;
						default:
							break;
						}
					} while (userOption != 0);
					//MENU USUARIO
				} else {
					printMessage("¡Ha habido un error!", 2);
				}
			}
			break;
		case 2:
			if (User_Membership(userList, MAX_USERS) == 0) {
				printMessage("¡Usuario creado con exito!", 2);
			} else {
				printMessage("¡Ha habido un error en el registro!", 2);
			}
			break;
		case 0:
			printMessage("¡Gracias por usar nuestro programa!", 2);
			break;
		default:
			printMessage("Por favor, ingrese un numero del 0 al 2.", 2);
			break;
		}
	} while (startOption != 0);
	return EXIT_SUCCESS;
}
